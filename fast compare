Sub CompareSheetsLargeData()
    Dim ws1 As Worksheet, ws2 As Worksheet, ws3 As Worksheet
    Dim lastRow1 As Long, lastRow2 As Long, lastRow3 As Long
    Dim i As Long, j As Long
    Dim dict As Object
    Dim rowToCopy As Long
    Dim data1 As Variant, data2 As Variant

    ' Set the worksheets
    Set ws1 = ThisWorkbook.Sheets("Sheet1")
    Set ws2 = ThisWorkbook.Sheets("Sheet2")
    Set ws3 = ThisWorkbook.Sheets("Sheet3")
    
    ' Find the last rows in each sheet
    lastRow1 = ws1.Cells(ws1.Rows.Count, 1).End(xlUp).Row
    lastRow2 = ws2.Cells(ws2.Rows.Count, 1).End(xlUp).Row
    
    ' Load data into arrays
    data1 = ws1.Range("A1:A" & lastRow1).Value
    data2 = ws2.Range("A1:A" & lastRow2).Value
    
    ' Create a dictionary to store values from Sheet2
    Set dict = CreateObject("Scripting.Dictionary")
    
    ' Populate the dictionary with values from Sheet2
    For j = 1 To UBound(data2, 1)
        dict(data2(j, 1)) = True
    Next j
    
    ' Clear contents of Sheet3
    ws3.Cells.Clear
    lastRow3 = 1 ' Start at the first row in Sheet3
    
    ' Loop through each row in the array from Sheet1
    For i = 1 To UBound(data1, 1)
        If Not dict.exists(data1(i, 1)) Then
            ws3.Rows(lastRow3).Value = ws1.Rows(i).Value
            ' Highlight the row in Sheet3
            ws3.Rows(lastRow3).Interior.Color = RGB(255, 255, 0) ' Yellow highlight
            lastRow3 = lastRow3 + 1
        End If
    Next i
    
    MsgBox "Comparison complete! Non-matching rows have been copied to Sheet3."
End Sub