Sub CompareAndCopyRows()
    Dim ws1 As Worksheet, ws2 As Worksheet, ws3 As Worksheet
    Dim lastRow1 As Long, lastRow2 As Long, lastCol1 As Long, lastCol2 As Long
    Dim i As Long, j As Long, k As Long
    Dim rowFound As Boolean
    Dim rng1 As Range, rng2 As Range
    
    Set ws1 = ThisWorkbook.Sheets("Sheet1")
    Set ws2 = ThisWorkbook.Sheets("Sheet2")
    Set ws3 = ThisWorkbook.Sheets("Sheet3")
    
    ' Find last row and column in Sheet1
    lastRow1 = ws1.Cells(ws1.Rows.Count, 1).End(xlUp).Row
    lastCol1 = ws1.Cells(1, ws1.Columns.Count).End(xlToLeft).Column
    
    ' Find last row and column in Sheet2
    lastRow2 = ws2.Cells(ws2.Rows.Count, 1).End(xlUp).Row
    lastCol2 = ws2.Cells(1, ws2.Columns.Count).End(xlToLeft).Column
    
    ' Clear Sheet3
    ws3.Cells.Clear
    
    ' Initialize row counter for Sheet3
    k = 1
    
    ' Loop through each row in Sheet1
    For i = 1 To lastRow1
        ' Ignore empty rows
        If WorksheetFunction.CountA(ws1.Rows(i)) > 0 Then
            rowFound = False
            ' Loop through each row in Sheet2
            For j = 1 To lastRow2
                ' Compare the rows
                Set rng1 = ws1.Rows(i).Resize(1, lastCol1)
                Set rng2 = ws2.Rows(j).Resize(1, lastCol2)
                
                If Application.WorksheetFunction.CountIfs(rng1, rng2) = lastCol1 Then
                    rowFound = True
                    Exit For
                End If
            Next j
            
            ' If row is not found in Sheet2
            If Not rowFound Then
                ' Highlight the row in Sheet1
                ws1.Rows(i).Interior.Color = RGB(255, 255, 0) ' Yellow
                
                ' Copy the row to Sheet3
                ws1.Rows(i).Copy Destination:=ws3.Rows(k)
                k = k + 1
            End If
        End If
    Next i
    
    MsgBox "Comparison complete. Rows not found in Sheet2 have been highlighted in Sheet1 and copied to Sheet3."
End Sub